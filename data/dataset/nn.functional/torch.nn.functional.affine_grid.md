torch.nn.functional.affine_grid 
===================================================================================================

torch.nn.functional. affine_grid ( *theta*  , *size*  , *align_corners = None* ) [source](https://github.com/pytorch/pytorch/blob/v2.8.0/torch/nn/functional.py#L5107) 
:   Generate 2D or 3D flow field (sampling grid), given a batch of affine matrices `theta`  . 

Note 

This function is often used in conjunction with [`grid_sample()`](torch.nn.functional.grid_sample.html#torch.nn.functional.grid_sample "torch.nn.functional.grid_sample")  to build [Spatial Transformer Networks](https://arxiv.org/abs/1506.02025)  .

Parameters
:   * **theta** ( [*Tensor*](../tensors.html#torch.Tensor "torch.Tensor")  ) – input batch of affine matrices with shape
( <!-- MathML: <math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow>
<mi>
                N
               </mi>
<mo>
                ×
               </mo>
<mn>
                2
               </mn>
<mo>
                ×
               </mo>
<mn>
                3
               </mn>
</mrow>
<annotation encoding="application/x-tex">
               N times 2 times 3
              </annotation>
</semantics>
</math> -->N × 2 × 3 N times 2 times 3N × 2 × 3  ) for 2D or
( <!-- MathML: <math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow>
<mi>
                N
               </mi>
<mo>
                ×
               </mo>
<mn>
                3
               </mn>
<mo>
                ×
               </mo>
<mn>
                4
               </mn>
</mrow>
<annotation encoding="application/x-tex">
               N times 3 times 4
              </annotation>
</semantics>
</math> -->N × 3 × 4 N times 3 times 4N × 3 × 4  ) for 3D

* **size** ( [*torch.Size*](../size.html#torch.Size "torch.Size")  ) – the target output image size.
( <!-- MathML: <math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow>
<mi>
                N
               </mi>
<mo>
                ×
               </mo>
<mi>
                C
               </mi>
<mo>
                ×
               </mo>
<mi>
                H
               </mi>
<mo>
                ×
               </mo>
<mi>
                W
               </mi>
</mrow>
<annotation encoding="application/x-tex">
               N times C times H times W
              </annotation>
</semantics>
</math> -->N × C × H × W N times C times H times WN × C × H × W  for 2D or <!-- MathML: <math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow>
<mi>
                N
               </mi>
<mo>
                ×
               </mo>
<mi>
                C
               </mi>
<mo>
                ×
               </mo>
<mi>
                D
               </mi>
<mo>
                ×
               </mo>
<mi>
                H
               </mi>
<mo>
                ×
               </mo>
<mi>
                W
               </mi>
</mrow>
<annotation encoding="application/x-tex">
               N times C times D times H times W
              </annotation>
</semantics>
</math> -->N × C × D × H × W N times C times D times H times WN × C × D × H × W  for 3D)
Example: torch.Size((32, 3, 24, 24))

* **align_corners** ( [*bool*](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)") *,* *optional*  ) – if `True`  , consider `-1`  and `1`  to refer to the centers of the corner pixels rather than the image corners.
Refer to [`grid_sample()`](torch.nn.functional.grid_sample.html#torch.nn.functional.grid_sample "torch.nn.functional.grid_sample")  for a more complete description.
A grid generated by [`affine_grid()`](#torch.nn.functional.affine_grid "torch.nn.functional.affine_grid")  should be passed to [`grid_sample()`](torch.nn.functional.grid_sample.html#torch.nn.functional.grid_sample "torch.nn.functional.grid_sample")  with the same setting for this option.
Default: `False`

Returns
:   output Tensor of size ( <!-- MathML: <math xmlns="http://www.w3.org/1998/Math/MathML">
<semantics>
<mrow>
<mi>
              N
             </mi>
<mo>
              ×
             </mo>
<mi>
              H
             </mi>
<mo>
              ×
             </mo>
<mi>
              W
             </mi>
<mo>
              ×
             </mo>
<mn>
              2
             </mn>
</mrow>
<annotation encoding="application/x-tex">
             N times H times W times 2
            </annotation>
</semantics>
</math> -->N × H × W × 2 N times H times W times 2N × H × W × 2  )

Return type
:   output ( [Tensor](../tensors.html#torch.Tensor "torch.Tensor")  )

Warning 

When `align_corners = True`  , the grid positions depend on the pixel
size relative to the input image size, and so the locations sampled by [`grid_sample()`](torch.nn.functional.grid_sample.html#torch.nn.functional.grid_sample "torch.nn.functional.grid_sample")  will differ for the same input given at different
resolutions (that is, after being upsampled or downsampled).
The default behavior up to version 1.2.0 was `align_corners = True`  .
Since then, the default behavior has been changed to `align_corners = False`  ,
in order to bring it in line with the default for [`interpolate()`](torch.nn.functional.interpolate.html#torch.nn.functional.interpolate "torch.nn.functional.interpolate")  .

Warning 

When `align_corners = True`  , 2D affine transforms on 1D data and
3D affine transforms on 2D data (that is, when one of the spatial
dimensions has unit size) are ill-defined, and not an intended use case.
This is not a problem when `align_corners = False`  .
Up to version 1.2.0, all grid points along a unit dimension were
considered arbitrarily to be at `-1`  .
From version 1.3.0, under `align_corners = True`  all grid points
along a unit dimension are considered to be at `0`  (the center of the input image).

